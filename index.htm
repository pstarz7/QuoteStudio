<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>QuoteStudio — PSTARZ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,700&family=Inter:wght@300;400;600;900&family=Bebas+Neue&family=Space+Mono&family=Dancing+Script:wght@700&family=Cinzel:wght@700&family=Cormorant+Garamond:ital,wght@1,600&family=Montserrat:wght@800&family=Homemade+Apple&family=Special+Elite&display=swap" rel="stylesheet">
    <style>
        :root {
            --black: #08090a;
            --lilac-ash: #a7a2a9;
            --bright-snow: #f4f7f5;
            --charcoal: #575a5e;
            --carbon-black: #222823;
        }

        body { 
            background: var(--black); 
            color: var(--bright-snow); 
            font-family: 'Inter', sans-serif; 
            height: 100vh; 
            margin: 0; 
            display: flex; 
            flex-direction: column;
            overflow: hidden;
        }

        /* Fixed structural elements */
        .hero, .footer { flex-shrink: 0; background: var(--black); border-color: var(--carbon-black); z-index: 100; }
        .hero { border-bottom-width: 1px; padding: 0.75rem 1.5rem; }
        .footer { border-top-width: 1px; padding: 0.5rem 1.5rem; }

        .workspace { 
            flex: 1; 
            display: flex; 
            flex-direction: row; 
            overflow: hidden; 
        }

        /* Compact Preview Area */
        .preview-pane { 
            flex: 1; 
            background: #0d0e10; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 20px;
            background-image: radial-gradient(var(--carbon-black) 1px, transparent 1px);
            background-size: 20px 20px;
            position: relative;
        }

        canvas { 
            cursor: move; 
            touch-action: none; 
            background: var(--bright-snow); 
            box-shadow: 0 20px 60px rgba(0,0,0,0.8); 
            border: 1px solid var(--charcoal);
            max-width: 95%;
            max-height: 90%;
            height: auto !important;
            width: auto !important;
            object-fit: contain;
        }

        /* Scrollable Controls */
        .edit-pane { 
            width: 400px; 
            background: var(--black); 
            border-left: 1px solid var(--carbon-black); 
            overflow-y: auto; 
            padding: 1.5rem;
            scrollbar-width: thin;
        }

        /* Mobile UX: Sticky Preview on Top */
        @media (max-width: 1024px) {
            .workspace { flex-direction: column; }
            .preview-pane { 
                height: 35vh; 
                flex: none; 
                position: sticky; 
                top: 0; 
                z-index: 40;
                box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                padding: 10px;
            }
            .edit-pane { 
                width: 100%; 
                border-left: none; 
                height: auto; 
                flex: 1;
                padding-bottom: 100px; 
            }
            body { overflow: hidden; } 
        }

        .section-card { 
            background: var(--carbon-black); 
            border: 1px solid var(--charcoal); 
            padding: 1rem; 
            border-radius: 4px; 
            margin-bottom: 1rem; 
        }

        .ui-btn { 
            font-size: 8px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; 
            padding: 8px 4px; border-radius: 2px; transition: all 0.2s; 
            background: transparent; color: var(--lilac-ash); border: 1px solid var(--charcoal); 
        }
        .ui-btn:hover { border-color: var(--bright-snow); }
        .active-btn { border-color: var(--bright-snow) !important; background: var(--bright-snow) !important; color: var(--black) !important; }
        .active-filter { background: var(--lilac-ash) !important; color: var(--black) !important; border-color: var(--lilac-ash) !important; }

        textarea, select, input[type="text"] { 
            background: var(--black) !important; 
            color: var(--bright-snow) !important; 
            border: 1px solid var(--charcoal) !important; 
            width: 100%; font-size: 12px;
        }

        input[type="range"] { accent-color: var(--bright-snow); height: 2px; width: 100%; cursor: pointer; }
    </style>
</head>
<body>

<header class="hero flex justify-between items-center">
    <h1 class="text-lg font-black tracking-tighter uppercase text-[var(--bright-snow)]">QUOTE<span class="text-[var(--lilac-ash)]">STUDIO</span></h1>
    <div class="flex gap-2">
        <button onclick="resetPosition()" class="text-[9px] uppercase font-bold text-[var(--charcoal)] hover:text-white">Recenter</button>
        <button onclick="downloadImage()" class="bg-[var(--bright-snow)] text-[var(--black)] px-4 py-1.5 rounded-sm font-black text-[10px] uppercase tracking-widest hover:invert transition-all">Export</button>
    </div>
</header>

<div class="workspace">
    <section class="preview-pane">
        <canvas id="canvas" width="1080" height="1350"></canvas>
    </section>

    <aside class="edit-pane">
        <div class="section-card border-dashed">
            <h3 class="text-[9px] font-black uppercase mb-3 text-[var(--bright-snow)]">AI Wisdom Engine</h3>
            <div class="grid grid-cols-2 gap-2 mb-2">
                <input type="text" id="ai-mood" placeholder="Mood..." class="p-2">
                <select id="ai-type" class="p-2">
                    <option value="Philosophical">Philosophical</option>
                    <option value="Romantic">Romantic</option>
                    <option value="Funny">Funny</option>
                    <option value="Motivation">Motivation</option>
                    <option value="Poetic">Poetic</option>
                    <option value="Stoic">Stoic</option>
                </select>
            </div>
            <button onclick="generateAIQuotes()" class="w-full py-2 bg-[var(--charcoal)] text-white font-bold text-[9px] uppercase hover:bg-[var(--lilac-ash)] hover:text-black transition-all">Request 5 AI Quotes</button>
            <div id="ai-results" class="hidden mt-2 space-y-2 max-h-48 overflow-y-auto text-[10px] border-t border-[var(--charcoal)] pt-2"></div>
        </div>

        <div class="section-card">
            <h3 class="text-[9px] font-black uppercase mb-3 text-[var(--lilac-ash)]">Image & Filters</h3>
            <input type="file" id="upload" accept="image/*" class="text-[9px] mb-3" />
            <div class="flex flex-wrap gap-1.5 mb-4">
                <button onclick="setFilter('none')" id="f-none" class="filter-btn text-[8px] px-2 py-1 active-filter">RAW</button>
                <button onclick="setFilter('vintage')" id="f-vintage" class="filter-btn text-[8px] px-2 py-1">VINTAGE</button>
                <button onclick="setFilter('dark')" id="f-dark" class="filter-btn text-[8px] px-2 py-1">NOIR</button>
                <button onclick="setFilter('sad')" id="f-sad" class="filter-btn text-[8px] px-2 py-1">B&W</button>
                <button onclick="setFilter('happy')" id="f-happy" class="filter-btn text-[8px] px-2 py-1">VIVID</button>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div><span class="text-[8px] uppercase font-bold text-[var(--charcoal)]">Brightness</span><input type="range" id="brightness" min="10" max="150" value="100"></div>
                <div><span class="text-[8px] uppercase font-bold text-[var(--charcoal)]">Blur</span><input type="range" id="blur" min="0" max="30" value="0"></div>
            </div>
        </div>

        <div class="section-card">
            <h3 class="text-[9px] font-black uppercase mb-3 text-[var(--lilac-ash)]">Frame Geometry</h3>
            <div class="grid grid-cols-2 gap-2">
                <button onclick="setFrame('polaroid-classic')" id="btn-polaroid-classic" class="ui-btn active-btn">Portrait 4:5</button>
                <button onclick="setFrame('insta-story')" id="btn-insta-story" class="ui-btn">Story 9:16</button>
                <button onclick="setFrame('story-wide')" id="btn-story-wide" class="ui-btn">Story Wide</button>
                <button onclick="setFrame('polaroid-wide')" id="btn-polaroid-wide" class="ui-btn">Square Wide</button>
                <button onclick="setFrame('polaroid-tall')" id="btn-polaroid-tall" class="ui-btn">Text Down</button>
                <button onclick="setFrame('polaroid-rev')" id="btn-polaroid-rev" class="ui-btn">Text Up</button>
                <button onclick="setFrame('solid-color')" id="btn-solid-color" class="ui-btn col-span-2">Solid Canvas Mode</button>
            </div>
        </div>

        <div class="section-card">
            <h3 class="text-[9px] font-black uppercase mb-3 text-[var(--lilac-ash)]">Type Settings</h3>
            <textarea id="quoteText" rows="2" class="p-2 mb-3 outline-none">"Design is silence made visible."</textarea>
            <div class="flex gap-2 mb-3">
                <button onclick="toggleFormat('bold')" id="btn-bold" class="w-10 h-8 border border-[var(--charcoal)] text-[10px] font-bold">B</button>
                <button onclick="toggleFormat('italic')" id="btn-italic" class="w-10 h-8 border border-[var(--charcoal)] text-[10px] italic">I</button>
                <input type="color" id="fontColor" value="#08090a" class="flex-1 h-8 bg-transparent border-none cursor-pointer">
                <input type="color" id="bgColor" value="#f4f7f5" class="w-10 h-8 bg-transparent border-none cursor-pointer">
            </div>
            <select id="fontFamily" class="p-2 mb-3 text-xs">
                <option value="Playfair Display">Playfair Classic</option>
                <option value="Inter">Modern Inter</option>
                <option value="Bebas Neue">Bold Impact</option>
                <option value="Dancing Script">Dancing Script</option>
                <option value="Cinzel">Cinzel Roman</option>
                <option value="Cormorant Garamond">Elegant Garamond</option>
                <option value="Montserrat">Heavy Montserrat</option>
                <option value="Homemade Apple">Handwritten Pencil</option>
                <option value="Special Elite">Mechanical Type</option>
                <option value="Space Mono">Space Mono</option>
            </select>
            <div class="space-y-3">
                <div class="flex justify-between text-[8px] uppercase font-bold text-[var(--charcoal)]"><span>Scale</span><input type="range" id="fontSize" min="20" max="250" value="80" class="w-2/3"></div>
                <div class="flex justify-between text-[8px] uppercase font-bold text-[var(--charcoal)]"><span>Leading</span><input type="range" id="lineHeight" min="0.8" max="2.5" step="0.1" value="1.2" class="w-2/3"></div>
                <div class="flex justify-between text-[8px] uppercase font-bold text-[var(--charcoal)]"><span>Kerning</span><input type="range" id="letterSpacing" min="-5" max="50" value="0" class="w-2/3"></div>
            </div>
        </div>
    </aside>
</div>

<footer class="footer flex justify-between items-center">
    <p class="text-[8px] text-[var(--charcoal)] font-bold tracking-widest uppercase">© 2025 QUOTE STUDIO</p>
    <a href="https://my-new-portfolio-3sq7.vercel.app/" target="_blank" class="text-[8px] font-black uppercase tracking-widest text-[var(--lilac-ash)] hover:text-white transition-colors">Build with Vibe - PSTARZ</a>
</footer>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let bgImg = null;
const state = {
    text: `"Design is silence made visible."`,
    x: 540, y: 1100,
    fontSize: 80,
    fontFamily: 'Playfair Display',
    fontColor: '#08090a',
    bgColor: '#f4f7f5',
    lineHeight: 1.2,
    letterSpacing: 0,
    brightness: 100,
    blur: 0,
    frame: 'polaroid-classic',
    filter: 'none',
    isBold: false,
    isItalic: false,
    isDragging: false
};

const getPos = (e) => {
    const rect = canvas.getBoundingClientRect();
    const cx = e.touches ? e.touches[0].clientX : e.clientX;
    const cy = e.touches ? e.touches[0].clientY : e.clientY;
    return { x: (cx - rect.left) * (canvas.width / rect.width), y: (cy - rect.top) * (canvas.height / rect.height) };
};

canvas.addEventListener('mousedown', () => state.isDragging = true);
canvas.addEventListener('touchstart', (e) => { state.isDragging = true; }, {passive: true});
window.addEventListener('mousemove', (e) => { if(state.isDragging) { const p = getPos(e); state.x = p.x; state.y = p.y; draw(); } });
window.addEventListener('touchmove', (e) => { if(state.isDragging) { const p = getPos(e); state.x = p.x; state.y = p.y; draw(); } }, {passive: true});
window.addEventListener('mouseup', () => state.isDragging = false);
window.addEventListener('touchend', () => state.isDragging = false);

function resetPosition() { state.x = canvas.width/2; state.y = canvas.height/2; draw(); }

function toggleFormat(type) {
    if(type === 'bold') state.isBold = !state.isBold;
    if(type === 'italic') state.isItalic = !state.isItalic;
    document.getElementById('btn-bold').classList.toggle('active-btn', state.isBold);
    document.getElementById('btn-italic').classList.toggle('active-btn', state.isItalic);
    draw();
}

function generateAIQuotes() {
    const res = document.getElementById('ai-results');
    res.classList.remove('hidden');
    res.innerHTML = "<p class='animate-pulse'>Processing deep logic...</p>";
    
    setTimeout(() => {
        const quoteBank = {
            Philosophical: ["Wonder is the beginning of wisdom.", "The unexamined life is not worth living.", "He who has a why to live can bear almost any how.", "We are what we repeatedly do.", "Life is not a problem to be solved, but a reality to be experienced."],
            Romantic: ["In all the world, there is no heart for me like yours.", "To love is to see a glimpse of eternity.", "Whatever our souls are made of, his and mine are the same.", "To love and be loved is to feel the sun from both sides.", "Grow old along with me! The best is yet to be."],
            Motivation: ["Don't count the days, make the days count.", "Great work comes from loving what you do.", "Start where you are. Use what you have. Do what you can.", "The secret of getting ahead is getting started.", "It always seems impossible until it's done."],
            Poetic: ["The stars shine for those who dream.", "Ink is the blood of the soul.", "The woods are lovely, dark and deep.", "Hope is the thing with feathers that perches in the soul.", "Poetry is the rhythmical creation of beauty in words."],
            Stoic: ["You have power over your mind - not outside events.", "Waste no more time arguing what a good man should be. Be one.", "The best revenge is to be unlike him who performed the injury.", "If it is not right do not do it; if it is not true do not say it.", "Very little is needed to make a happy life."],
            Funny: ["I'm not lazy, I'm just on energy saving mode.", "My life is a constant battle between sleep and food.", "Common sense is like deodorant. The people who need it most never use it.", "I find television very educating. Every time somebody turns it on, I go into the other room and read a book.", "Better to remain silent and be thought a fool than to speak out and remove all doubt."]
        };
        const selected = quoteBank[document.getElementById('ai-type').value] || quoteBank.Philosophical;
        res.innerHTML = selected.map(q => `<div onclick="useQuote('${q.replace(/'/g, "\\'")}')" class="p-2 border-b border-[var(--charcoal)] hover:text-white cursor-pointer italic">"${q}"</div>`).join('');
    }, 400);
}

function useQuote(q) { state.text = `"${q}"`; document.getElementById('quoteText').value = state.text; draw(); }

['quoteText', 'fontSize', 'fontFamily', 'fontColor', 'bgColor', 'lineHeight', 'letterSpacing', 'brightness', 'blur'].forEach(id => {
    document.getElementById(id).addEventListener('input', (e) => {
        state[id === 'quoteText' ? 'text' : id] = e.target.value;
        draw();
    });
});

document.getElementById('upload').addEventListener('change', e => {
    const reader = new FileReader();
    reader.onload = (ev) => { bgImg = new Image(); bgImg.onload = draw; bgImg.src = ev.target.result; };
    reader.readAsDataURL(e.target.files[0]);
});

function setFrame(type) {
    state.frame = type;
    document.querySelectorAll('.ui-btn').forEach(b => b.classList.remove('active-btn'));
    document.getElementById('btn-' + type).classList.add('active-btn');
    canvas.height = type.includes('story') ? 1920 : 1350;
    resetPosition(); draw();
}

function setFilter(f) {
    state.filter = f;
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active-filter'));
    document.getElementById('f-' + f).classList.add('active-filter');
    draw();
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = state.bgColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    if (bgImg && state.frame !== 'solid-color') {
        ctx.save();
        let fStr = `brightness(${state.brightness}%) blur(${state.blur}px) `;
        if(state.filter==='vintage') fStr+='sepia(0.5) contrast(0.9)';
        if(state.filter==='dark') fStr+='brightness(0.4) contrast(1.5)';
        if(state.filter==='sad') fStr+='grayscale(1)';
        if(state.filter==='happy') fStr+='saturate(2)';
        ctx.filter = fStr;
        
        let ix=0, iy=0, iw=canvas.width, ih=canvas.height;
        if(state.frame === 'insta-story') { ix=100; iy=150; iw=880; ih=1000; }
        else if(state.frame === 'story-wide') { ix=80; iy=350; iw=920; ih=600; }
        else if(state.frame === 'polaroid-classic') { ix=120; iy=120; iw=840; ih=840; }
        else if(state.frame === 'polaroid-wide') { ix=100; iy=180; iw=880; ih=550; }
        else if(state.frame === 'polaroid-tall') { ix=80; iy=80; iw=920; ih=800; }
        else if(state.frame === 'polaroid-rev') { ix=80; iy=480; iw=920; ih=800; }

        const scale = Math.max(iw/bgImg.width, ih/bgImg.height);
        if(state.frame.includes('polaroid')) { ctx.shadowColor = "rgba(0,0,0,0.3)"; ctx.shadowBlur = 50; }
        ctx.beginPath(); ctx.rect(ix, iy, iw, ih); ctx.clip();
        ctx.drawImage(bgImg, ix+(iw-bgImg.width*scale)/2, iy+(ih-bgImg.height*scale)/2, bgImg.width*scale, bgImg.height*scale);
        ctx.restore();
    }

    ctx.save();
    ctx.fillStyle = state.fontColor; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    let fs = ""; if(state.isBold) fs+="bold "; if(state.isItalic) fs+="italic ";
    ctx.font = `${fs}${state.fontSize}px "${state.fontFamily}"`;
    ctx.letterSpacing = `${state.letterSpacing}px`;
    wrapText(ctx, state.text, state.x, state.y, canvas.width * 0.82, state.fontSize * state.lineHeight);
    ctx.restore();
}

function wrapText(context, text, x, y, maxWidth, lineHeight) {
    const words = text.split(' ');
    let line = '', lines = [];
    for (let n = 0; n < words.length; n++) {
        let testLine = line + words[n] + ' ';
        if (context.measureText(testLine).width > maxWidth) { lines.push(line); line = words[n] + ' '; }
        else { line = testLine; }
    }
    lines.push(line);
    let startY = y - ((lines.length - 1) * lineHeight) / 2;
    lines.forEach((l, i) => context.fillText(l.trim(), x, startY + (i * lineHeight)));
}

function downloadImage() {
    const link = document.createElement('a');
    link.download = `QuoteStudio-Artwork.png`;
    link.href = canvas.toDataURL('image/png', 1.0);
    link.click();
}

window.onload = draw;
</script>
</body>
</html>

